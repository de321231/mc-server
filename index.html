<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTFâ€‘8">
<meta name="viewport" content="width=device-width, initialâ€‘scale=1.0">
<title>MC Control Center</title>
<style>
body { background:#121212; color:#e0e0e0; font-family:sans-serif; display:flex;
justify-content:center; align-items:center; height:100vh; margin:0;}
.container { background:#1e1e1e; padding:30px; border-radius:15px; text-align:center;
width:350px; border:1px solid #333; }
button { padding:12px 0; width:100%; margin:6px 0; border:none; border-radius:8px;
font-weight:bold; cursor:pointer; }
.btnâ€‘start { background:#2e7d32; }
.btnâ€‘restart { background:#f9a825; color:#000; }
.btnâ€‘stop { background:#c62828; }
#statusDisplay { margin:15px 0; font-size:16px; }
</style>
</head>
<body>

<div class="container">
  <h2>ðŸŽ® MC Server Control</h2>

  <div id="statusDisplay">Status: lÃ¤dtâ€¦</div>

  <button class="btnâ€‘start" onclick="sendPower('start')">ðŸŸ¢ Start</button>
  <button class="btnâ€‘restart" onclick="sendPower('restart')">ðŸ”„ Neustart</button>
  <button class="btnâ€‘stop" onclick="sendPower('stop')">ðŸ”´ Stop</button>

  <div id="resultMsg"></div>
</div>

<script>
// APIâ€‘URLs (lokal durch Vercel serviert)
const STATUS_URL = '/api/status';
const POWER_URL = '/api/power';

// Serverâ€‘Status abrufen
async function updateStatus() {
  const statusDisplay = document.getElementById("statusDisplay");
  try {
    const res = await fetch("/api/status");
    const json = await res.json();
    statusDisplay.innerText = "Status: " + (json.status || "unbekannt");
  } catch (err) {
    statusDisplay.innerText = "Status: Fehler beim Abruf";
    console.error(err);
  }
}


// Powerâ€‘Befehl senden
async function sendPower(action) {
  const result = document.getElementById("resultMsg");
  result.innerText = "Sende Befehlâ€¦";
  try {
    const res = await fetch(POWER_URL, {
      method: "POST",
      headers: { "Contentâ€‘Type": "application/json" },
      body: JSON.stringify({ action })
    });
    const json = await res.json();
    if (res.ok) result.innerText = json.message;
    else result.innerText = "Fehler: " + (json.error || json.detail);
    updateStatus();
  } catch {
    result.innerText = "Netzwerkfehler!";
  }
}

updateStatus(); // einmal beim Laden
setInterval(updateStatus, 5000); // alle 5s aktualisieren
</script>

</body>
</html>
